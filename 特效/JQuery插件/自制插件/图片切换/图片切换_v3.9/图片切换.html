<!doctype html> 
<html> 
<head> 
	<meta charset="utf-8">
	<title>图片切换</title>
	<script src="js/jquery-1.9.1.js"></script>
	<style type="text/css">
		body{
			padding: 0;
			margin: 0;
		}
		header{
			width: 100%;
			height: 80px;
			position: fixed;
			top: 0;
			bottom: 0;
			background: black;
			opacity: 0.7;
		}
		header h1{
			color: white;
			text-align: center;
		}
		footer{
			width: 100%;
			height: auto;
			position: fixed;
			top: auto;
			bottom: 0;
			background: black;
			opacity: 0.7;
		}
		footer p{
			margin: 10px 0;
			color: white;
			text-align: center;
		}
		section{
			padding: 100px 0;
			text-align: center;
		}
		.copy{
			padding: 0;
			margin: 0 20px 5px 0;
			height: 14px;
			font-size: 14px;
			color: red;
			float: right;
		}
	</style>
	<style type="text/css">
		section{
			/* border: 1px solid red; */
			width:100%;
			/* max-width: 1200px; */
			height: 300px;
			position: absolute;
		}
		#box{
			/* border: 1px solid red; */
			margin: 0 auto;
			width: 100%;
			height: 100%;
			position: relative;
			/* top: 50%; */
			overflow: hidden;
		}
		#box #imgs{
			width: 9999px;
			height: 100%;
			position: absolute;
		}
		#box #imgs>div{
			/*width: 253px;
			height: 508px;
			width: 100%;
			height: 100%;*/
			float: left;
			height:100%;
			position: relative;
		}
		#box div img{
			height: 100%;
		}
		#box #pre{
			width: 39px;
			height: 44px;
			display: block;
			position: absolute;
			top: 45%;
			background: url('img/pre.png');
			z-index: 99;
		}
		#box #next{
			width: 39px;
			height: 44px;
			display: block;
			position: absolute;
			right: 0;
			top: 45%;
			background: url('img/next.png');
		}
		/* 影藏 */
		#box .showDiv{
			position: absolute;
			width: 100%;
			height: 100%;
			/*display: block;*/
			float: left;
			top: 0;
			background: #000;
			opacity:0.8;
		}
		#box .boxa{
			display:none; 	
			position:absolute;
			background:#000;
			height:70px;
			width:230px;
			opacity:1;
			text-align:left;
			color:white;
			left:0;
			bottom:10%;
			text-decoration:none;
		}
		#box .address{
			margin-bottom: 5px;
			margin-left: 10%;
			font-size: 18px;
		}
		#box .time{
			margin-top: 0;
			margin-left: 10%;
			font-size: 14px;
		}
	</style>
	
</head>
<body>
	<header>
		<h1>问题：图片切换</h1>
	</header>
	<section>
		<div id="box">
			<a id="pre" href="javascript:void(0)" ></a>
			<div id="imgs">
				<div id="item1">
					<img src="img/1.png" alt="成都.jpg" title="成都.jpg" >
					<div class="showDiv">
			            <a class="boxa" href="http://www.baidu.com" title="成都站">
			              <h3 class="address">今天成都站</h3>
			              <h2 class="time">2009-5-9</h2>
						</a>
			        </div>
				</div>
				<div id="item2">
					<img src="img/2.png" alt="杭州.jpg" title="杭州.jpg" >
					<div class="showDiv">
						<a class="boxa" href="http://www.baidu.com" title="杭州站">
			              <h3 class="address">今天杭州站</h3>
			              <h2 class="time">2009-5-9</h2>
						</a>
					</div>
				</div>
				<div id="item3">
					<img src="img/3.png" alt="深圳.jpg" title="深圳.jpg" >
					<div class="showDiv">
						<a class="boxa" href="http://www.baidu.com" title="深圳站">
			              <h3 class="address">今天深圳站</h3>
			              <h2 class="time">2009-5-9</h2>
						</a>
					</div>
				</div>
				<div id="item4">
					<img src="img/5.png" alt="上海.jpg" title="上海.jpg" >
					<div class="showDiv">
						<a class="boxa" href="http://www.baidu.com" title="上海站">
			              <h3 class="address">今天上海站</h3>
			              <h2 class="time">2009-5-9</h2>
						</a>
					</div>
				</div>
				<div id="item5">
					<img src="img/gz.jpg" alt="广州.jpg" title="广州.jpg" >
					<div class="showDiv">
			            <a class="boxa" href="http://www.baidu.com" title="广州站">
			              <h3 class="address">今天广州站</h3>
			              <h2 class="time">2009-5-9</h2>
			            </a>
					</div>
				</div>
				<div id="item6">
					<img src="img/bj.jpg" alt="北京.jpg" title="北京.jpg" >
					<div class="showDiv">
			            <a class="boxa" href="http://www.baidu.com" title="北京站">
			              <h3 class="address">今天北京站</h3>
			              <h2 class="time">2009-5-9</h2>
			            </a>
					</div>
				</div>
				<div id="item7">
					<img src="img/nj.jpg" alt="南京.jpg" title="南京.jpg" >
					<div class="showDiv">
			            <a class="boxa" href="http://www.baidu.com" title="南京站">
			              <h3 class="address">今天南京站</h3>
			              <h2 class="time">2009-5-9</h2>
			            </a>
					</div>
				</div>
				<div id="item8">
					<img src="img/xa.jpg" alt="西安.jpg" title="西安.jpg" >
					<div class="showDiv">
			            <a class="boxa" href="http://www.baidu.com" title="西安站">
			              <h3 class="address">今天西安站</h3>
			              <h2 class="time">2009-5-9</h2>
			            </a>
					</div>
				</div>
			</div>
			<a id="next" href="javascript:void(0)" ></a>
		</div>
	</section>
	<footer>
		<p>结论：</p>
		<p></p>
		<p class="copy">Powered by Gavin(小牧COOL)</p>
	</footer>
	<script type="text/javascript">
		$(function(){
		setTimeout(function(){
			$("#item1 .showDiv").children(".boxa").fadeIn(100);
			$("#item1 .showDiv").css({
				background : "none"
			});
			var pre = $("#pre");
			var next = $("#next");
			var imgs = $("#imgs");
			var divs = $("#imgs > div");
			var showDivs = $(".showDiv");
			var count = 0;
			var divNow = 0;
			showDivs.click(function(){
				$(".boxa").fadeOut(100);
				$(".showDiv").css({
					background : "#000",
					opacity : 0.8
				});
				$(this).children(".boxa").fadeIn(100);
				$(this).css({
					background : "none"
				});
			});
			var firstOne = divs.first();
			var lastOne = divs.last();
			lastOne.insertBefore(firstOne);
			var boxWidth =  $("#box").width();
			var marLeft = (lastOne.width() - (boxWidth/2-firstOne.width()/2))*-1;
			imgs.css({marginLeft:marLeft+"px"});

			pre.click(function(){
				/*var allWidth = 0;
				for(var i=0;i<divs.length;i++){
					allWidth = allWidth + divs[i].clientWidth;
				}
				boxWidth =  $("#box").width();
				var maxWidth = -(allWidth - boxWidth);
				if(divNow <= 0){
					divNow = 0;
				}else if(divNow >= divs.length-1){
					divNow = divs.length - 1;
				}
				divNow = divNow - 1;
				var b = divNow;
				if(divNow <= 0){
					b = 0;
				}
				var centerWidth = boxWidth/2-((divs[divNow].clientWidth)/2);
				if(count <= maxWidth){
					nowAfterWidth = 0;
					for(var i=divNow;i<divs.length;i++){
						nowAfterWidth += divs[i].clientWidth;
					}
					if(nowAfterWidth <= boxWidth - centerWidth){
						count = maxWidth - centerWidth;
					}else{
						count = -(allWidth - nowAfterWidth);
					}
				}else{
					count = count + divs[b].clientWidth;
				}
				if(count >= 0){
					count = 0;
					centerWidth = 0;
				}
				$(".boxa").fadeOut(100);
				$(".showDiv").css({
					background : "#000",
					opacity : 0.8
				});*/
				boxWidth =  $("#box").width();
				divs = $("#imgs > div");
				divs.last().insertBefore(divs.first());
				marLeft = (divs[divNow].clientWidth + boxWidth)*-1;
				imgs.css({marginLeft:marLeft + "px"});
				var a = divNow + 1;
				if(divNow<=0){
					a = 1;
				}
				$("#item"+a+" .showDiv").children(".boxa").fadeIn(100);
				$("#item"+a+" .showDiv").css({
					background : "none"
				});
				imgs.animate({
					marginLeft: "-" + divs[divNow].clientWidth + "px"
				},1000);
				divNow = divNow -1;
			});
			next.click(function(){
				divNow = divNow + 1;
				boxWidth =  $("#box").width();
				divs = $("#imgs > div");
				marLeft = (divs[divNow].clientWidth/2 + divs[divNow + 1].clientWidth/2)*-1;
				imgs.animate({
					marginLeft: marLeft + "px"
				},1000,function(){
					/*divs = $("#imgs > div");
					divs.first().insertAfter(divs.last());
					marLeft = marLeft - divs.first().clientWidth
					imgs.css({marginLeft: marLeft + "px"});*/
				});
				//divNow = divNow + 1;
				/*var allWidth = 0;
				for(var i=0;i<divs.length;i++){
					allWidth = allWidth + divs[i].clientWidth;
				}
				boxWidth =  $("#box").width();
				var maxWidth = -(allWidth - boxWidth);
				if(divNow <= -1){
					divNow = 0;
				}else if(divNow >= divs.length - 1){
					divNow = divs.length - 2;
				}
				count = count - divs[divNow].clientWidth;
				divNow = divNow + 1;
				var centerWidth = boxWidth/2-((divs[divNow].clientWidth)/2);
				if(count <= (maxWidth - centerWidth)){
					count = (maxWidth - centerWidth);
				}
				console.log("count=" + count);
				console.log("boxWidth=" + boxWidth);
				console.log("maxWidth=" + maxWidth);
				console.log("nowWidth=" + divs[divNow].clientWidth + ",now=" + (divNow));
				console.log("left=" + (count + centerWidth));

				$(".boxa").fadeOut(100);
				$(".showDiv").css({
					background : "#000",
					opacity : 0.8
				});
				$("#item"+(divNow+1)+" .showDiv").children(".boxa").fadeIn(100);
				$("#item"+(divNow+1)+" .showDiv").css({
					background : "none"
				});
				imgs.animate({
					left: count + centerWidth
				},1000);*/
			});
		},200);
		});
	</script>
</body>
</html>